{"description": "Enterprise techniques used by Turla, ATT&CK group G0010 v1.3", "name": "Turla (G0010)", "domain": "mitre-enterprise", "version": "3.0", "techniques": [{"techniqueID": "T1134", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1134.002", "showSubtechniques": true, "comment": "Turla RPC backdoors can impersonate or steal process tokens before executing commands.[5]    "}, {"techniqueID": "T1087", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1087.002", "showSubtechniques": true, "comment": "Turla has used net user /domain to enumerate domain accounts.[8]"}, {"score": 1, "techniqueID": "T1087.001", "showSubtechniques": true, "comment": "Turla has used net user to enumerate local accounts on the system.[8]"}, {"techniqueID": "T1071", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1071.001", "showSubtechniques": true, "comment": "Turla has used HTTP and HTTPS for C2 communications.[4][6]"}, {"techniqueID": "T1560", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1560.001", "showSubtechniques": true, "comment": "Turla has encrypted files stolen from connected USB drives into a RAR file before exfiltration.[7]"}, {"techniqueID": "T1547", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1547.001", "showSubtechniques": true, "comment": "A Turla Javascript backdoor added a local_update_check value under the Registry key HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run to establish persistence. Additionally, a Turla custom executable containing Metasploit shellcode is saved to the Startup folder to gain persistence.[4][6]"}, {"score": 1, "techniqueID": "T1547.004", "showSubtechniques": true, "comment": "Turla established persistence by adding a Shell value under the Registry key HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion]Winlogon.[4]"}, {"score": 1, "techniqueID": "T1110", "showSubtechniques": false, "comment": "Turla may attempt to connect to systems within a victim's network using net use commands and a predefined list or collection of passwords.[1]"}, {"techniqueID": "T1059", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1059.001", "showSubtechniques": true, "comment": "Turla has used PowerShell to execute commands/scripts, in some cases via a custom executable or code from Empire's PSInject.[6][5][7] Turla has also used PowerShell scripts to load and execute malware in memory."}, {"score": 1, "techniqueID": "T1059.003", "showSubtechniques": true, "comment": "Turla RPC backdoors have used cmd.exe to execute commands.[5][7]"}, {"score": 1, "techniqueID": "T1059.005", "showSubtechniques": true, "comment": "Turla has used VBS scripts throughout its operations.[7] "}, {"score": 1, "techniqueID": "T1555", "showSubtechniques": false, "comment": "Turla has gathered credentials from the Windows Credential Manager tool.[7]  "}, {"score": 1, "techniqueID": "T1213", "showSubtechniques": false, "comment": "Turla has used a custom .NET tool to collect documents from an organization's internal central database.[8]"}, {"score": 1, "techniqueID": "T1005", "showSubtechniques": false, "comment": "Turla RPC backdoors can upload files from victim machines.[5]"}, {"score": 1, "techniqueID": "T1025", "showSubtechniques": false, "comment": "Turla RPC backdoors can collect files from USB thumb drives.[5][7]"}, {"score": 1, "techniqueID": "T1140", "showSubtechniques": false, "comment": "Turla has used a custom decryption routine, which pulls key and salt values from other artifacts such as a WMI filter or PowerShell Profile, to decode encrypted PowerShell payloads.[5]"}, {"score": 1, "techniqueID": "T1189", "showSubtechniques": false, "comment": "Turla has infected victims using watering holes.[8]"}, {"techniqueID": "T1546", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1546.013", "showSubtechniques": true, "comment": "Turla has used PowerShell profiles to maintain persistence on an infected machine.[5]"}, {"score": 1, "techniqueID": "T1546.003", "showSubtechniques": true, "comment": "Turla has used WMI event filters and consumers to establish persistence.[5]"}, {"techniqueID": "T1567", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1567.002", "showSubtechniques": true, "comment": "Turla has used WebDAV to upload stolen USB files to a cloud drive.[7] Turla has also exfiltrated stolen files to OneDrive and 4shared.[8]"}, {"score": 1, "techniqueID": "T1083", "showSubtechniques": false, "comment": "Turla surveys a system upon check-in to discover files in specific locations on the hard disk %TEMP% directory, the current user's desktop, the Program Files directory, and Recent.[1][8] Turla RPC backdoors have also searched for files matching the lPH*.dll pattern.[5]"}, {"techniqueID": "T1562", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1562.001", "showSubtechniques": true, "comment": "Turla has used a AMSI bypass, which patches the in-memory amsi.dll, in PowerShell scripts to bypass Windows antimalware products.[5]"}, {"score": 1, "techniqueID": "T1105", "showSubtechniques": false, "comment": "Turla has used shellcode to download Meterpreter after compromising a victim.[6]"}, {"score": 1, "techniqueID": "T1570", "showSubtechniques": false, "comment": "Turla RPC backdoors can be used to transfer files to/from victim machines on the local network.[5][7]"}, {"score": 1, "techniqueID": "T1112", "showSubtechniques": false, "comment": "Turla has used the Registry to store encrypted payloads.[5][7]"}, {"score": 1, "techniqueID": "T1106", "showSubtechniques": false, "comment": "Turla and its RPC backdoors have used APIs calls for various tasks related to subverting AMSI and accessing then executing commands through RPC and/or named pipes.[5]"}, {"score": 1, "techniqueID": "T1027", "showSubtechniques": true, "comment": "Turla has used encryption (including salted 3DES via PowerSploit's Out-EncryptedScript.ps1), random variable names, and base64 encoding to obfuscate PowerShell commands and payloads.[5]"}, {"score": 1, "techniqueID": "T1027.005", "showSubtechniques": true, "comment": "Based on comparison of Gazer versions, Turla made an effort to obfuscate strings in the malware that could be used as IoCs, including the mutex name and named pipe.[2]"}, {"score": 1, "techniqueID": "T1201", "showSubtechniques": false, "comment": "Turla has used net accounts and net accounts /domain to acquire password policy information.[8]"}, {"score": 1, "techniqueID": "T1120", "showSubtechniques": false, "comment": "Turla has used fsutil fsinfo drives to list connected drives.[8]"}, {"techniqueID": "T1069", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1069.002", "showSubtechniques": true, "comment": "Turla has used net group \"Domain Admins\" /domain to identify domain administrators.[8]"}, {"score": 1, "techniqueID": "T1069.001", "showSubtechniques": true, "comment": "Turla has used net localgroup and net localgroup Administrators to enumerate group information, including members of the local administrators group.[8]"}, {"techniqueID": "T1566", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1566.002", "showSubtechniques": true, "comment": "Turla attempted to trick targets into clicking on a link featuring a seemingly legitimate domain from Adobe.com to download their malware and gain initial access.[4]"}, {"score": 1, "techniqueID": "T1566.001", "showSubtechniques": true, "comment": "Turla has used spearphishing emails to deliver BrainTest as a malicious attachment.[9]"}, {"score": 1, "techniqueID": "T1057", "showSubtechniques": false, "comment": "Turla surveys a system upon check-in to discover running processes using the tasklist /v command.[1] Turla RPC backdoors have also enumerated processes associated with specific open ports or named pipes.[5]"}, {"score": 1, "techniqueID": "T1055", "showSubtechniques": true, "comment": "Turla has also used PowerSploit's Invoke-ReflectivePEInjection.ps1 to reflectively load a PowerShell payload into a random process on the victim system.[5]"}, {"score": 1, "techniqueID": "T1055.001", "showSubtechniques": true, "comment": "Turla has used Metasploit to perform reflective DLL injection in order to escalate privileges.[6][10]"}, {"score": 1, "techniqueID": "T1090", "showSubtechniques": false, "comment": "Turla RPC backdoors have included local UPnP RPC proxies.[5] "}, {"score": 1, "techniqueID": "T1012", "showSubtechniques": false, "comment": "Turla surveys a system upon check-in to discover information in the Windows Registry with the reg query command.[1] Turla has also retrieved PowerShell payloads hidden in Registry keys as well as checking keys associated with null session named pipes .[5]"}, {"techniqueID": "T1021", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1021.002", "showSubtechniques": true, "comment": "Turla used net use commands to connect to lateral systems within a network.[1]"}, {"score": 1, "techniqueID": "T1018", "showSubtechniques": false, "comment": "Turla surveys a system upon check-in to discover remote systems on a local network using the net view and net view /DOMAIN commands. Turla has also used net group \"Domain Computers\" /domain, net group \"Domain Controllers\" /domain, and net group \"Exchange Servers\" /domain to enumerate domain computers, including the organization's DC and Exchange Server.[1][8]"}, {"techniqueID": "T1518", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1518.001", "showSubtechniques": true, "comment": "Turla has obtained information on security software, including security logging information that may indicate whether their malware has been detected.[8]"}, {"score": 1, "techniqueID": "T1082", "showSubtechniques": false, "comment": "Turla surveys a system upon check-in to discover operating system configuration details using the systeminfo, gpresult, and set commands.[1][8]"}, {"score": 1, "techniqueID": "T1016", "showSubtechniques": false, "comment": "Turla surveys a system upon check-in to discover network configuration details using the arp -a, nbtstat -n, nbtscan, net config, ipconfig /all, and route commands.[1][7][8] Turla RPC backdoors have also retrieved registered RPC interface information from process memory.[5]"}, {"score": 1, "techniqueID": "T1049", "showSubtechniques": false, "comment": "Turla surveys a system upon check-in to discover active local network connections using the netstat -an, net use, net file, and net session commands.[1][8] Turla RPC backdoors have also enumerated the IPv4 TCP connection table via the GetTcpTable2 API call.[5]"}, {"score": 1, "techniqueID": "T1007", "showSubtechniques": false, "comment": "Turla surveys a system upon check-in to discover running services and associated processes using the tasklist /svc command.[1]"}, {"score": 1, "techniqueID": "T1124", "showSubtechniques": false, "comment": "Turla surveys a system upon check-in to discover the system time by using the net time command.[1]"}, {"techniqueID": "T1204", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1204.001", "showSubtechniques": true, "comment": "Turla has used spearphishing via a link to get users to download and run their malware.[4]"}, {"techniqueID": "T1102", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1102.002", "showSubtechniques": true, "comment": "A Turla JavaScript backdoor has used Google Apps Script as its C2 server.[4][6]"}], "gradient": {"colors": ["#ffffff", "#66b1ff"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by Turla", "color": "#66b1ff"}]}