{"description": "Enterprise techniques used by Rocke, ATT&CK group G0106 v1.0", "name": "Rocke (G0106)", "domain": "mitre-enterprise", "version": "3.0", "techniques": [{"score": 1, "techniqueID": "T1071", "showSubtechniques": true, "comment": "Rocke issued wget requests from infected systems to the C2.[1]"}, {"score": 1, "techniqueID": "T1071.001", "showSubtechniques": true, "comment": "Rocke has executed wget and curl commands to Pastebin over the HTTPS protocol.[2]"}, {"techniqueID": "T1547", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1547.001", "showSubtechniques": true, "comment": "Rocke's miner has created UPX-packed files in the Windows Start Menu Folder.[1]   "}, {"score": 1, "techniqueID": "T1037", "showSubtechniques": false, "comment": "Rocke has installed an \"init.d\" startup script to maintain persistence.[2]    "}, {"techniqueID": "T1059", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1059.004", "showSubtechniques": true, "comment": "Rocke used shell scripts to run commands which would obtain persistence and execute the cryptocurrency mining malware.[1] "}, {"score": 1, "techniqueID": "T1059.006", "showSubtechniques": true, "comment": "Rocke has used Python-based malware to install and spread their coinminer.[2]"}, {"techniqueID": "T1543", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1543.002", "showSubtechniques": true, "comment": "Rocke has installed a systemd service script to maintain persistence.[2]  "}, {"score": 1, "techniqueID": "T1140", "showSubtechniques": false, "comment": "Rocke has extracted tar.gz files after downloading them from a C2 server.[1]"}, {"score": 1, "techniqueID": "T1190", "showSubtechniques": false, "comment": "Rocke exploited Apache Struts, Oracle WebLogic (CVE-2017-10271), and Adobe ColdFusion (CVE-2017-3066) vulnerabilities to deliver malware.[1][3]"}, {"techniqueID": "T1222", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1222.002", "showSubtechniques": true, "comment": "Rocke has changed file permissions of files so they could not be modified.[2] "}, {"techniqueID": "T1564", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1564.001", "showSubtechniques": true, "comment": "Rocke downloaded a file \"libprocesshider\", which could hide files on the target system.[1][3]"}, {"techniqueID": "T1574", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1574.006", "showSubtechniques": true, "comment": "Rocke has modified /etc/ld.so.preload to hook libc functions in order to hide the installed dropper and mining software in process lists.[2]  "}, {"techniqueID": "T1562", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1562.001", "showSubtechniques": true, "comment": "Rocke used scripts which detected and uninstalled antivirus software.[1][3]"}, {"score": 1, "techniqueID": "T1562.004", "showSubtechniques": true, "comment": "Rocke used scripts which killed processes and added firewall rules to block traffic related to other cryptominers.[1] "}, {"techniqueID": "T1070", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1070.006", "showSubtechniques": true, "comment": "Rocke has changed the time stamp of certain files.[2] "}, {"score": 1, "techniqueID": "T1070.004", "showSubtechniques": true, "comment": "Rocke has deleted files on infected machines.[2]  "}, {"score": 1, "techniqueID": "T1070.002", "showSubtechniques": true, "comment": "Rocke has cleared log files within the /var/log/ folder.[2]"}, {"score": 1, "techniqueID": "T1105", "showSubtechniques": false, "comment": "Rocke used malware to download additional malicious files to the target system.[1]    "}, {"techniqueID": "T1036", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1036.005", "showSubtechniques": true, "comment": "Rocke has used shell scripts which download mining executables and saves them with the filename \"java\".[1]"}, {"score": 1, "techniqueID": "T1046", "showSubtechniques": false, "comment": "Rocke conducted scanning for exposed TCP port 7001 as well as SSH and Redis servers.[1][2]"}, {"score": 1, "techniqueID": "T1571", "showSubtechniques": false, "comment": "Rocke's miner connects to a C2 server using port 51640.[2]    "}, {"score": 1, "techniqueID": "T1027", "showSubtechniques": true, "comment": "Rocke has modified UPX headers after packing files to break unpackers.[2]"}, {"score": 1, "techniqueID": "T1027.002", "showSubtechniques": true, "comment": "Rocke's miner has created UPX-packed files in the Windows Start Menu Folder.[1][3][2]"}, {"score": 1, "techniqueID": "T1027.004", "showSubtechniques": true, "comment": "Rocke has compiled malware, delivered to victims as .c files, with the GNU Compiler Collection (GCC).[2]  "}, {"score": 1, "techniqueID": "T1057", "showSubtechniques": false, "comment": "Rocke can detect a running process's PID on the infected machine.[2]  "}, {"techniqueID": "T1055", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1055.002", "showSubtechniques": true, "comment": "Rocke's miner, \"TermsHost.exe\", evaded defenses by injecting itself into Windows processes, including Notepad.exe.[1] "}, {"techniqueID": "T1021", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1021.004", "showSubtechniques": true, "comment": "Rocke has spread its coinminer via SSH.[2]    "}, {"score": 1, "techniqueID": "T1018", "showSubtechniques": false, "comment": "Rocke has looked for IP addresses in the known_hosts file on the infected system and attempted to SSH into them.[1]   "}, {"score": 1, "techniqueID": "T1496", "showSubtechniques": false, "comment": "Rocke has distributed cryptomining malware.[1][3]"}, {"score": 1, "techniqueID": "T1014", "showSubtechniques": false, "comment": "Rocke has modified /etc/ld.so.preload to hook libc functions in order to hide the installed dropper and mining software in process lists.[2]"}, {"techniqueID": "T1053", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1053.003", "showSubtechniques": true, "comment": "Rocke installed a cron job that downloaded and executed files from the C2.[1][3][2]"}, {"techniqueID": "T1518", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1518.001", "showSubtechniques": true, "comment": "Rocke used scripts which detected and uninstalled antivirus software.[1][3]"}, {"score": 1, "techniqueID": "T1082", "showSubtechniques": false, "comment": "Rocke has used uname -m to collect the name and information about the infected system's kernel.[2]"}, {"techniqueID": "T1552", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1552.004", "showSubtechniques": true, "comment": "Rocke has used SSH private keys on the infected machine to spread its coinminer throughout a network.[2]"}, {"score": 1, "techniqueID": "T1102", "showSubtechniques": true, "comment": "Rocke has used Pastebin, Gitee, and GitLab for Command and Control.[2][1]"}, {"score": 1, "techniqueID": "T1102.001", "showSubtechniques": true, "comment": "Rocke has used Pastebin to check the version of beaconing malware and redirect to another Pastebin hosting updated malware.[2]"}], "gradient": {"colors": ["#ffffff", "#66b1ff"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by Rocke", "color": "#66b1ff"}]}