{"description": "Enterprise techniques used by Patchwork, ATT&CK group G0040 v1.2", "name": "Patchwork (G0040)", "domain": "mitre-enterprise", "version": "3.0", "techniques": [{"techniqueID": "T1548", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1548.002", "showSubtechniques": true, "comment": "Patchwork bypassed User Access Control (UAC).[1]"}, {"score": 1, "techniqueID": "T1560", "showSubtechniques": false, "comment": "Patchwork encrypted the collected files' path with AES and then encoded them with base64.[3]"}, {"score": 1, "techniqueID": "T1119", "showSubtechniques": false, "comment": "Patchwork developed a file stealer to search C:\\ and collect files with certain extensions. Patchwork also executed a script to enumerate all drives, store them as a list, and upload generated files to the C2 server.[3]"}, {"score": 1, "techniqueID": "T1197", "showSubtechniques": false, "comment": "Patchwork has used BITS jobs to download malicious payloads.[7]"}, {"techniqueID": "T1547", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1547.001", "showSubtechniques": true, "comment": "Patchwork has added the path of its second-stage malware to the startup folder to achieve persistence. One of its file stealers has also persisted by adding a Registry Run key.[1][3]"}, {"techniqueID": "T1059", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1059.001", "showSubtechniques": true, "comment": "Patchwork used PowerSploit to download payloads, run a reverse shell, and execute malware on the victim's machine.[1][3]"}, {"score": 1, "techniqueID": "T1059.003", "showSubtechniques": true, "comment": "Patchwork ran a reverse shell with Meterpreter.[1] Patchwork used JavaScript code and .SCT files on victim machines.[3][4]"}, {"score": 1, "techniqueID": "T1059.005", "showSubtechniques": true, "comment": "Patchwork used Visual Basic Scripts (VBS) on victim machines.[3][4]"}, {"techniqueID": "T1555", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1555.003", "showSubtechniques": true, "comment": "Patchwork dumped the login data database from \\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data.[1]"}, {"techniqueID": "T1132", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1132.001", "showSubtechniques": true, "comment": "Patchwork used Base64 to encode C2 traffic.[1]"}, {"score": 1, "techniqueID": "T1005", "showSubtechniques": false, "comment": "Patchwork collected and exfiltrated files from the infected system.[1]"}, {"techniqueID": "T1074", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1074.001", "showSubtechniques": true, "comment": "Patchwork copied all targeted files to a directory called index that was eventually uploaded to the C&amp;C server.[3]"}, {"score": 1, "techniqueID": "T1189", "showSubtechniques": false, "comment": "Patchwork has used watering holes to deliver files with exploits to initial victims.[2][4]"}, {"score": 1, "techniqueID": "T1203", "showSubtechniques": false, "comment": "Patchwork uses malicious documents to deliver remote execution exploits as part of. The group has previously exploited CVE-2017-8570, CVE-2012-1856, CVE-2014-4114, CVE-2017-0199, CVE-2017-11882, and CVE-2015-1641.[1][5][2][6][3][4][7]"}, {"score": 1, "techniqueID": "T1083", "showSubtechniques": false, "comment": "A Patchwork payload has searched all fixed drives on the victim for files matching a specified list of extensions.[1][3]"}, {"techniqueID": "T1574", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1574.002", "showSubtechniques": true, "comment": "A Patchwork .dll that contains BADNEWS is loaded and executed using DLL side-loading.[3]"}, {"techniqueID": "T1070", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1070.004", "showSubtechniques": true, "comment": "Patchwork removed certain files and replaced them so they could not be retrieved.[3]"}, {"score": 1, "techniqueID": "T1105", "showSubtechniques": false, "comment": "Patchwork payloads download additional files from the C2 server.[5][3]"}, {"techniqueID": "T1559", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1559.002", "showSubtechniques": true, "comment": "Patchwork leveraged the DDE protocol to deliver their malware.[3]"}, {"techniqueID": "T1036", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1036.005", "showSubtechniques": true, "comment": "Patchwork installed its payload in the startup programs folder as \"Baidu Software Update.\" The group also adds its second stage payload to the startup programs as \"Net Monitor.\"[1] They have also dropped QuasarRAT binaries as files named microsoft_network.exe and crome.exe.[4]"}, {"score": 1, "techniqueID": "T1112", "showSubtechniques": false, "comment": "A Patchwork payload deletes Resiliency Registry keys created by Microsoft Office applications in an apparent effort to trick users into thinking there were no issues during application runs.[3]"}, {"score": 1, "techniqueID": "T1027", "showSubtechniques": true, "comment": "Patchwork has obfuscated a script with Crypto Obfuscator.[3]"}, {"score": 1, "techniqueID": "T1027.001", "showSubtechniques": true, "comment": "Patchwork apparently altered NDiskMonitor samples by adding four bytes of random letters in a likely attempt to change the file hashes.[3]"}, {"score": 1, "techniqueID": "T1027.005", "showSubtechniques": true, "comment": "Patchwork apparently altered NDiskMonitor samples by adding four bytes of random letters in a likely attempt to change the file hashes.[3]"}, {"score": 1, "techniqueID": "T1027.002", "showSubtechniques": true, "comment": "A Patchwork payload was packed with UPX.[5]"}, {"techniqueID": "T1566", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1566.001", "showSubtechniques": true, "comment": "Patchwork has used spearphishing with an attachment to deliver files with exploits to initial victims.[1][5][3][4]"}, {"score": 1, "techniqueID": "T1566.002", "showSubtechniques": true, "comment": "Patchwork has used spearphishing with links to deliver files with exploits to initial victims. The group has also used embedded image tags (known as web bugs) with unique, per-recipient tracking links in their emails for the purpose of identifying which recipients opened messages.[2][3][4][7]"}, {"techniqueID": "T1055", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1055.012", "showSubtechniques": true, "comment": "A Patchwork payload uses process hollowing to hide the UAC bypass vulnerability exploitation inside svchost.exe.[1]"}, {"techniqueID": "T1021", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1021.001", "showSubtechniques": true, "comment": "Patchwork attempted to use RDP to move laterally.[1]"}, {"techniqueID": "T1053", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1053.005", "showSubtechniques": true, "comment": "A Patchwork file stealer can run a TaskScheduler DLL to add persistence.[3]"}, {"techniqueID": "T1518", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1518.001", "showSubtechniques": true, "comment": "Patchwork scanned the \"Program Files\" directories for a directory with the string \"Total Security\" (the installation path of the \"360 Total Security\" antivirus tool).[1]"}, {"techniqueID": "T1553", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1553.002", "showSubtechniques": true, "comment": "Patchwork has signed malware with self signed certificates from fictitious and spoofed legitimate software companies.[7]"}, {"score": 1, "techniqueID": "T1082", "showSubtechniques": false, "comment": "Patchwork collected the victim computer name, OS version, and architecture type and sent the information to its C2 server. Patchwork also enumerated all available drives on the victim's machine.[1][3]"}, {"score": 1, "techniqueID": "T1033", "showSubtechniques": false, "comment": "Patchwork collected the victim username and whether it was running as admin, then sent the information to its C2 server.[1][3]"}, {"techniqueID": "T1204", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1204.002", "showSubtechniques": true, "comment": "Patchwork embedded a malicious macro in a Word document and lured the victim to click on an icon to execute the malware.[3][4]"}, {"score": 1, "techniqueID": "T1204.001", "showSubtechniques": true, "comment": "Patchwork has used spearphishing with links to try to get users to click, download and open malicious files.[2][3][4][7]"}, {"techniqueID": "T1102", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1102.001", "showSubtechniques": true, "comment": "Patchwork hides base64-encoded and encrypted C2 server locations in comments on legitimate websites.[5]"}], "gradient": {"colors": ["#ffffff", "#66b1ff"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by Patchwork", "color": "#66b1ff"}]}