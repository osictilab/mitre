{"description": "Enterprise techniques used by MuddyWater, ATT&CK group G0069 v2.2", "name": "MuddyWater (G0069)", "domain": "mitre-enterprise", "version": "3.0", "techniques": [{"techniqueID": "T1548", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1548.002", "showSubtechniques": true, "comment": "MuddyWater uses various techniques to bypass UAC.[3]"}, {"techniqueID": "T1071", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1071.001", "showSubtechniques": true, "comment": "MuddyWater has used HTTP for C2 communications.[4]"}, {"techniqueID": "T1560", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1560.001", "showSubtechniques": true, "comment": "MuddyWater has used the native Windows cabinet creation tool, makecab.exe, likely to compress stolen data to be uploaded.[2]"}, {"techniqueID": "T1547", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1547.001", "showSubtechniques": true, "comment": "MuddyWater has added Registry Run key KCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\SystemTextEncoding to establish persistence.[6][8][7][5]"}, {"techniqueID": "T1059", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1059.003", "showSubtechniques": true, "comment": "MuddyWater has used a custom tool for creating reverse shells.[2] MuddyWater has used JavaScript files to execute its POWERSTATS payload.[6][9][8][2][3]"}, {"score": 1, "techniqueID": "T1059.001", "showSubtechniques": true, "comment": "MuddyWater has used PowerShell for execution.[6][9][8][2][3][7][5]"}, {"score": 1, "techniqueID": "T1059.005", "showSubtechniques": true, "comment": "MuddyWater has used VBScript files to execute its POWERSTATS payload, as well as macros.[6][9][8][2][3][4][5]"}, {"score": 1, "techniqueID": "T1555", "showSubtechniques": true, "comment": "MuddyWater has performed credential dumping with LaZagne and other tools, including by dumping passwords saved in victim email.[1][2]"}, {"score": 1, "techniqueID": "T1555.003", "showSubtechniques": true, "comment": "MuddyWater has run a tool that steals passwords saved in victim web browsers.[2]"}, {"techniqueID": "T1132", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1132.001", "showSubtechniques": true, "comment": "MuddyWater has base64 encoded C2 communications.[4]"}, {"score": 1, "techniqueID": "T1140", "showSubtechniques": false, "comment": "MuddyWater decoded base64-encoded PowerShell commands using a VBS file.[6][9][3]"}, {"score": 1, "techniqueID": "T1041", "showSubtechniques": false, "comment": "MuddyWater has used C2 infrastructure to receive exfiltrated data.[5]"}, {"score": 1, "techniqueID": "T1203", "showSubtechniques": false, "comment": "MuddyWater has exploited the Office vulnerability CVE-2017-0199 for execution.[4]"}, {"score": 1, "techniqueID": "T1083", "showSubtechniques": false, "comment": "MuddyWater has used malware that checked if the ProgramData folder had folders or files with the keywords \"Kasper,\" \"Panda,\" or \"ESET.\"[8]"}, {"score": 1, "techniqueID": "T1105", "showSubtechniques": false, "comment": "MuddyWater has used malware that can upload additional files to the victim\u2019s machine.[8][3][5]"}, {"techniqueID": "T1559", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1559.002", "showSubtechniques": true, "comment": "MuddyWater has used malware that can execute PowerShell scripts via DDE.[8]"}, {"score": 1, "techniqueID": "T1559.001", "showSubtechniques": true, "comment": "MuddyWater has used malware that has the capability to execute malicious code via COM, DCOM, and Outlook.[8][4]"}, {"techniqueID": "T1036", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1036.005", "showSubtechniques": true, "comment": "MuddyWater has used filenames and Registry key names associated with Windows Defender.[6][7]"}, {"score": 1, "techniqueID": "T1104", "showSubtechniques": false, "comment": "MuddyWater has used one C2 to obtain enumeration scripts and monitor web logs, but a different C2 to send data back.[7] "}, {"score": 1, "techniqueID": "T1027", "showSubtechniques": true, "comment": "MuddyWater has used Daniel Bohannon\u2019s Invoke-Obfuscation framework.[1][10] The group has also used other obfuscation methods, including Base64 obfuscation of VBScripts and PowerShell commands.[1][6][8][7][4]"}, {"score": 1, "techniqueID": "T1027.004", "showSubtechniques": true, "comment": "MuddyWater has used the .NET csc.exe tool to compile executables from downloaded C# code.[3]"}, {"score": 1, "techniqueID": "T1027.003", "showSubtechniques": true, "comment": "MuddyWater has stored obfuscated JavaScript code in an image file named temp.jpg.[3]"}, {"techniqueID": "T1137", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1137.001", "showSubtechniques": true, "comment": "MuddyWater has used a Word Template, Normal.dotm, for persistence.[5]"}, {"techniqueID": "T1003", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1003.001", "showSubtechniques": true, "comment": "MuddyWater has performed credential dumping with Mimikatz.[1][2]"}, {"score": 1, "techniqueID": "T1003.004", "showSubtechniques": true, "comment": "MuddyWater has performed credential dumping with LaZagne.[1][2]"}, {"score": 1, "techniqueID": "T1003.005", "showSubtechniques": true, "comment": "MuddyWater has performed credential dumping with LaZagne.[1][2]"}, {"techniqueID": "T1566", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1566.001", "showSubtechniques": true, "comment": "MuddyWater has compromised third parties and used compromised accounts to send spearphishing emails with targeted attachments to recipients.[1][6][8][4]"}, {"score": 1, "techniqueID": "T1057", "showSubtechniques": false, "comment": "MuddyWater has used malware to obtain a list of running processes on the system.[8][4]"}, {"techniqueID": "T1090", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1090.002", "showSubtechniques": true, "comment": "MuddyWater has controlled POWERSTATS from behind a proxy network to obfuscate the C2 location.[2] MuddyWater has used a series of compromised websites that victims connected to randomly to relay information to command and control (C2).[5]"}, {"techniqueID": "T1053", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1053.005", "showSubtechniques": true, "comment": "MuddyWater has used scheduled tasks to establish persistence.[5]"}, {"score": 1, "techniqueID": "T1113", "showSubtechniques": false, "comment": "MuddyWater has used malware that can capture screenshots of the victim\u2019s machine.[8]"}, {"techniqueID": "T1218", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1218.011", "showSubtechniques": true, "comment": "MuddyWater has used malware that leveraged rundll32.exe in a Registry Run key to execute a .dll.[8]"}, {"score": 1, "techniqueID": "T1218.003", "showSubtechniques": true, "comment": "MuddyWater has used CMSTP.exe and a malicious INF to execute its POWERSTATS payload.[6]"}, {"score": 1, "techniqueID": "T1218.005", "showSubtechniques": true, "comment": "MuddyWater has used mshta.exe to execute its POWERSTATS payload and to pass a PowerShell one-liner for execution.[6][8]"}, {"techniqueID": "T1518", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1518.001", "showSubtechniques": true, "comment": "MuddyWater has used malware to check running processes against a hard-coded list of security tools often used by malware researchers.[8]"}, {"score": 1, "techniqueID": "T1082", "showSubtechniques": false, "comment": "MuddyWater has used malware that can collect the victim\u2019s OS version and machine name.[8][7][5]"}, {"score": 1, "techniqueID": "T1016", "showSubtechniques": false, "comment": "MuddyWater has used malware to collect the victim\u2019s IP address and domain name.[8]"}, {"score": 1, "techniqueID": "T1033", "showSubtechniques": false, "comment": "MuddyWater has used malware that can collect the victim\u2019s username.[8]"}, {"techniqueID": "T1552", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1552.001", "showSubtechniques": true, "comment": "MuddyWater has run a tool that steals passwords saved in victim email.[2]"}, {"techniqueID": "T1204", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1204.002", "showSubtechniques": true, "comment": "MuddyWater has attempted to get users to enable macros and launch malicious Microsoft Word documents delivered via spearphishing emails.[1][6][8][7][4][5]"}, {"score": 1, "techniqueID": "T1047", "showSubtechniques": false, "comment": "MuddyWater has used malware that leveraged WMI for execution and querying host information.[8][3][7]"}], "gradient": {"colors": ["#ffffff", "#66b1ff"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by MuddyWater", "color": "#66b1ff"}]}