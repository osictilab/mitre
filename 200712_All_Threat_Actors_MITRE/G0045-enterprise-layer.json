{"description": "Enterprise techniques used by menuPass, ATT&CK group G0045 v1.4", "name": "menuPass (G0045)", "domain": "mitre-enterprise", "version": "3.0", "techniques": [{"techniqueID": "T1087", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1087.002", "showSubtechniques": true, "comment": "menuPass has used the Microsoft administration tool csvde.exe to export Active Directory data.[7]"}, {"score": 1, "techniqueID": "T1560", "showSubtechniques": true, "comment": "menuPass has encrypted files and information before exfiltration.[6]"}, {"score": 1, "techniqueID": "T1560.001", "showSubtechniques": true, "comment": "menuPass has compressed files before exfiltration using TAR and RAR.[4][7]"}, {"techniqueID": "T1059", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1059.003", "showSubtechniques": true, "comment": "menuPass executes commands using a command-line interface and reverse shell. The group has used a modified version of pentesting script wmiexec.vbs to execute commands.[4][7][8][10] menuPass has used malicious macros embedded inside Office documents to execute files.[9][10]"}, {"score": 1, "techniqueID": "T1059.001", "showSubtechniques": true, "comment": "menuPass uses PowerSploit to inject shellcode into PowerShell.[7]"}, {"score": 1, "techniqueID": "T1005", "showSubtechniques": false, "comment": "menuPass has collected various files from the compromised computers.[6]"}, {"score": 1, "techniqueID": "T1039", "showSubtechniques": false, "comment": "menuPass has collected data from remote systems by mounting network shares with net use and using Robocopy to transfer data.[4]"}, {"techniqueID": "T1074", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1074.001", "showSubtechniques": true, "comment": "menuPass stages data prior to exfiltration in multi-part archives, often saved in the Recycle Bin.[4]"}, {"score": 1, "techniqueID": "T1074.002", "showSubtechniques": true, "comment": "menuPass has staged data on remote MSP systems or other victim networks prior to exfiltration.[4]"}, {"score": 1, "techniqueID": "T1140", "showSubtechniques": false, "comment": "menuPass has used certutil in a macro to decode base64-encoded content contained in a dropper document attached to an email. The group has also used certutil -decode to decode files on the victim\u2019s machine when dropping UPPERCUT.[9][10]"}, {"techniqueID": "T1574", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1574.001", "showSubtechniques": true, "comment": "menuPass has used DLL search order hijacking.[4]"}, {"score": 1, "techniqueID": "T1574.002", "showSubtechniques": true, "comment": "menuPass has used DLL side-loading to launch versions of Mimikatz and PwDump6 as well as UPPERCUT.[7][10]"}, {"techniqueID": "T1070", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1070.004", "showSubtechniques": true, "comment": "A menuPass macro deletes files after it has decoded and decompressed them.[9][6]"}, {"score": 1, "techniqueID": "T1105", "showSubtechniques": false, "comment": "menuPass has installed updates and new malware on victims.[4][6]"}, {"techniqueID": "T1056", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1056.001", "showSubtechniques": true, "comment": "menuPass has used key loggers to steal usernames and passwords.[6]"}, {"score": 1, "techniqueID": "T1036", "showSubtechniques": true, "comment": "menuPass has used esentutl to change file extensions to their true type that were masquerading as .txt files.[10] "}, {"score": 1, "techniqueID": "T1036.005", "showSubtechniques": true, "comment": "menuPass has been seen changing malicious files to appear legitimate.[6]"}, {"score": 1, "techniqueID": "T1036.003", "showSubtechniques": true, "comment": "menuPass has renamed certutil and moved it to a different location on the system to avoid detection based on use of the tool.[10]"}, {"score": 1, "techniqueID": "T1046", "showSubtechniques": false, "comment": "menuPass has used tcping.exe, similar to Ping, to probe port status on systems of interest.[7]"}, {"score": 1, "techniqueID": "T1027", "showSubtechniques": false, "comment": "menuPass has encoded strings in its malware with base64 as well as with a simple, single-byte XOR obfuscation using key 0x40.[9][10]"}, {"techniqueID": "T1003", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1003.002", "showSubtechniques": true, "comment": "menuPass has used a modified version of pentesting tools wmiexec.vbs and secretsdump.py to dump credentials.[7][8]"}, {"score": 1, "techniqueID": "T1003.004", "showSubtechniques": true, "comment": "menuPass has used a modified version of pentesting tools wmiexec.vbs and secretsdump.py to dump credentials.[7][8]"}, {"techniqueID": "T1566", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1566.001", "showSubtechniques": true, "comment": "menuPass has sent malicious Office documents via email as part of spearphishing campaigns as well as executables disguised as documents.[7][5][10][6]"}, {"techniqueID": "T1055", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1055.012", "showSubtechniques": true, "comment": "menuPass has used process hollowing in iexplore.exe to load the RedLeaves implant.[9]"}, {"techniqueID": "T1090", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1090.002", "showSubtechniques": true, "comment": "menuPass has used a global service provider's IP as a proxy for C2 traffic from a victim.[5][10]"}, {"techniqueID": "T1021", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1021.001", "showSubtechniques": true, "comment": "menuPass has used RDP connections to move across the victim network.[4][6]"}, {"score": 1, "techniqueID": "T1021.004", "showSubtechniques": true, "comment": "menuPass has used Putty Secure Copy Client (PSCP) to transfer data.[4]"}, {"score": 1, "techniqueID": "T1018", "showSubtechniques": false, "comment": "menuPass uses scripts to enumerate IP ranges on the victim network. menuPass has also issued the command net view /domain to a PlugX implant to gather information about remote systems on the network.[7][5]"}, {"techniqueID": "T1053", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1053.005", "showSubtechniques": true, "comment": "menuPass has used a script (atexec.py) to execute a command on a target machine via Task Scheduler.[7]"}, {"score": 1, "techniqueID": "T1016", "showSubtechniques": false, "comment": "menuPass has used several tools to scan for open NetBIOS nameservers and enumerate NetBIOS sessions.[7]"}, {"score": 1, "techniqueID": "T1049", "showSubtechniques": false, "comment": "menuPass has used net use to conduct connectivity checks to machines.[4]"}, {"score": 1, "techniqueID": "T1199", "showSubtechniques": false, "comment": "menuPass has used legitimate access granted to Managed Service Providers in order to access victims of interest.[7][5]"}, {"techniqueID": "T1204", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1204.002", "showSubtechniques": true, "comment": "menuPass has attempted to get victims to open malicious files such as Windows Shortcuts (.lnk) and/or Microsoft Office documents, sent via email as part of spearphishing campaigns.[7][5][9][6][10]"}, {"score": 1, "techniqueID": "T1078", "showSubtechniques": false, "comment": "menuPass has used valid accounts shared between Managed Service Providers and clients to move between the two environments.[4]"}, {"score": 1, "techniqueID": "T1047", "showSubtechniques": false, "comment": "menuPass uses a modified version of pentesting script wmiexec.vbs, which logs into a remote machine using WMI.[7][8]"}], "gradient": {"colors": ["#ffffff", "#66b1ff"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by menuPass", "color": "#66b1ff"}]}